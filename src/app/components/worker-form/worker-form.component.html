<section class="worker-form-section">
  <header class="worker-form-header">
    <button mat-icon-button routerLink="/workers">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <h2>{{ formTitle() }}</h2>
    <button mat-flat-button type="submit" form="worker-form">Zapisz</button>
  </header>
  <mat-divider></mat-divider>
  <form
    [formGroup]="workerFrom"
    class="worker-form"
    id="worker-form"
    (submit)="handleSubmit()"
  >
    <div>{{ error() }}</div>
    <mat-card appearance="outlined">
      <mat-card-header>
        <mat-card-title>Dane Personalne</mat-card-title>
      </mat-card-header>
      <mat-card-content class="worker-form-group">
        <mat-form-field appearance="outline">
          <mat-label>Imię</mat-label>
          <input
            matInput
            type="text"
            formControlName="firstName"
            placeholder="Imię"
            autocomplete="given-name"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Drugie Imię</mat-label>
          <input
            matInput
            type="text"
            formControlName="secondName"
            placeholder="Drugie Imię"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Nazwisko</mat-label>
          <input
            matInput
            type="text"
            formControlName="lastName"
            placeholder="Nazwisko"
            autocomplete="family-name"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Matka</mat-label>
          <input
            matInput
            type="text"
            formControlName="mother"
            placeholder="Matka"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Ojciec</mat-label>
          <input
            matInput
            type="text"
            formControlName="father"
            placeholder="Ojciec"
          />
        </mat-form-field>
      </mat-card-content>
    </mat-card>

    <mat-card appearance="outlined">
      <mat-card-header>
        <mat-card-title>Dane Kontaktowe</mat-card-title>
      </mat-card-header>
      <mat-card-content class="worker-form-group">
        <mat-form-field appearance="outline">
          <mat-label>Telefon</mat-label>
          <input
            matInput
            type="text"
            formControlName="phone"
            placeholder="Telefon"
            autocomplete="tel"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Telefon alarmowy</mat-label>
          <input
            matInput
            type="text"
            formControlName="phoneIce"
            placeholder="Telefon"
            autocomplete="tel"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Email</mat-label>
          <input
            matInput
            type="email"
            formControlName="email"
            placeholder="email"
            autocomplete="email"
          />
        </mat-form-field>
      </mat-card-content>
    </mat-card>

    <mat-card appearance="outlined">
      <mat-card-header>
        <mat-card-title>Dane Dodatkowe</mat-card-title>
      </mat-card-header>
      <mat-card-content class="worker-form-group">
        <mat-form-field appearance="outline">
          <mat-label>Ksywa</mat-label>
          <input
            matInput
            type="text"
            formControlName="nickname"
            placeholder="Ksywa"
          />
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Kolor</mat-label>
          <input
            matInput
            type="color"
            formControlName="color"
            placeholder="Kolor"
          />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Ekipa</mat-label>
          <mat-select formControlName="teamId" name="teamId" required>
            @for (team of hints.teams; track team) {
            <mat-option [value]="team.id">{{ team.name }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
        <mat-form-field appearance="outline">
          <mat-label>Grupa</mat-label>
          <mat-select formControlName="groupId" name="groupId" required>
            @for (group of hints.groups; track group) {
            <mat-option [value]="group.id">{{ group.name }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </mat-card-content>
    </mat-card>

    <mat-divider />
    <mat-card appearance="outlined">
      <mat-card-header>
        <mat-card-title>Dane Dokumenty</mat-card-title>
      </mat-card-header>
      <mat-card-content class="worker-form-group">
        <div class="worker-form-group">
          <mat-form-field appearance="outline">
            <mat-label>Pesel</mat-label>
            <input
              matInput
              type="text"
              formControlName="pesel"
              placeholder="Pesel"
              maxlength="12"
            />
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Numer i Seria Dowód osobisty</mat-label>
            <input
              matInput
              type="text"
              formControlName="docNumber"
              placeholder="Numer i Seria"
              maxlength="9"
            />
          </mat-form-field>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-divider />

    <div class="worker-form-group">
      <mat-checkbox formControlName="hasAccount" (change)="toggleAccount()"
        >Konto w aplikacji</mat-checkbox
      >
    </div>

    @if (workerFrom.controls.user?.status !== "DISABLED") {
    <div [formGroup]="workerAccount">
      <div class="worker-form-group">
        <mat-form-field appearance="outline">
          <mat-label>Login</mat-label>
          <input
            matInput
            type="text"
            formControlName="username"
            placeholder="Login"
          />
        </mat-form-field>
      </div>

      <div class="worker-form-group">
        <mat-form-field appearance="outline">
          <mat-label>Hasło</mat-label>
          <input
            matInput
            type="password"
            formControlName="password"
            placeholder="Hasło"
          />
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Powtórz hasło</mat-label>
          <input
            matInput
            type="password"
            formControlName="password2"
            placeholder="Hasło"
          />
        </mat-form-field>
      </div>
      <div class="worker-form-group">
        <mat-form-field appearance="outline">
          <mat-label>Rodzaj kąta</mat-label>
          <mat-select formControlName="authority" name="team">
            @for (authority of hints.authorities; track authority) {
            <mat-option [value]="authority">{{ authority }}</mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>
    </div>
    }
  </form>
</section>
